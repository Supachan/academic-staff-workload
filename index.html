<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dropdown Submission</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <div class="dropdown">
      <button class="btn btn-primary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
        เลือกชื่อ
      </button>
      <ul class="dropdown-menu">
        <!-- Dropdown items will be added dynamically -->
      </ul>
    </div>

    <!-- Placeholder to show the selected name -->
    <p id="selectedName" class="mt-3">Selected Name: None</p>

    <!-- Submit Button -->
    <button id="submitBtn" class="btn btn-success mt-3" disabled>Submit</button>
  </div>

  <script>
    const names = [
      "นายแพทย์สมเกียรติ ลีละศิธร",
      "แพทย์หญิงวัชรา ริ้วไพบูลย์",
      "ศ.ดร.ทวี  เชื้อสุวรรณทวี",
      "รศ.ดร.อาดัม นีละไพจิตร",
      "รศ.ดร.ณัฏฐนียา โตรักษา",
    ];

    const dropdownMenu = document.querySelector(".dropdown-menu");
    const selectedNameElement = document.getElementById("selectedName");
    const submitBtn = document.getElementById("submitBtn");
    let selectedName = ""; // Store the selected name

    // Populate dropdown menu and handle selection
    names.forEach((name) => {
      const listItem = document.createElement("li");
      const link = document.createElement("a");
      link.className = "dropdown-item";
      link.href = "#";
      link.textContent = name;

      // Add event listener to each dropdown item
      link.addEventListener("click", (event) => {
        event.preventDefault();
        selectedName = name; // Update the selected name
        selectedNameElement.textContent = `Selected Name: ${name}`; // Display the selected name
        submitBtn.disabled = false; // Enable the submit button
      });

      listItem.appendChild(link);
      dropdownMenu.appendChild(listItem);
    });

    // Submit data to Google Sheet
    // submitBtn.addEventListener("click", () => {
    //   if (selectedName) {
    //     const proxy = "https://cors-anywhere.herokuapp.com/";
    //     // const webAppURL = proxy + "YOUR_WEB_APP_URL_HERE";
    //     const webAppURL = proxy + "https://script.google.com/macros/s/AKfycbzsNZGxsOWntLfS2bdmfMLMInRyGcD8TJmHReL5CepxqbzzxhCIuDcK1gTl8TbLVAD_HQ/exec"; // Replace with your Google Apps Script Web App URL
    //     fetch(webAppURL, {
    //       method: "POST",
    //       headers: {
    //         "Content-Type": "application/json",
    //       },
    //       body: JSON.stringify({ name: selectedName }),
    //     })
    //       .then((response) => response.json())
    //       .then((data) => {
    //         if (data.status === "success") {
    //           alert("Data submitted successfully!");
    //           submitBtn.disabled = true; // Disable the button again after submission
    //           selectedNameElement.textContent = "Selected Name: None"; // Reset selected name
    //           selectedName = ""; // Clear the selected name
    //         } else {
    //           alert("Submission failed. Please try again.");
    //         }
    //       })
    //       .catch((error) => {
    //         console.error("Error:", error);
    //         alert("An error occurred. Please check the console.");
    //       });
    //   }
    // });
    submitBtn.addEventListener("click", () => {
  if (selectedName) {
    const proxy = "https://cors-anywhere.herokuapp.com/";
    const webAppURL = proxy+"https://script.google.com/macros/s/AKfycbwkGSNQq6VzVfIaHscmZUZba2KHx0qiS_0OAtY0oNqr/dev"; // Replace with your Google Apps Script Web App URL
    fetch(webAppURL, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ name: selectedName }),
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        return response.json();
      })
      .then((data) => {
        if (data.status === "success") {
          alert("Data submitted successfully!");
        } else {
          alert("Submission failed. Please try again.");
        }
      })
      .catch((error) => {
        console.error("Error during fetch:", error);
        alert(`An error occurred: ${error.message}`);
      });
  }
});

  </script>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
